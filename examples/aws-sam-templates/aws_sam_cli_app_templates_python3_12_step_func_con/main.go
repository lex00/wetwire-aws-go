// Package template contains CloudFormation resources.
// Main resources
//
// Generated by wetwire-aws import.
package template

import (
	. "github.com/lex00/wetwire-aws-go/intrinsics"
	"github.com/lex00/wetwire-aws-go/resources/serverless"
)

var SfnToStockBuyerFunctionConnector = serverless.Connector{
	Destination: Json{
	"Id": "StockBuyerFunction",
},
	Permissions: []any{"Write"},
	Source: Json{
	"Id": "StockTradingStateMachine",
},
}

var SfnToStockCheckerFunctionConnector = serverless.Connector{
	Destination: Json{
	"Id": "StockCheckerFunction",
},
	Permissions: []any{"Write"},
	Source: Json{
	"Id": "StockTradingStateMachine",
},
}

var SfnToStockSellerFunctionConnector = serverless.Connector{
	Destination: Json{
	"Id": "StockSellerFunction",
},
	Permissions: []any{"Write"},
	Source: Json{
	"Id": "StockTradingStateMachine",
},
}

var SfnToTransactionTableConnector = serverless.Connector{
	Destination: Json{
	"Id": "TransactionTable",
},
	Permissions: []any{"Write"},
	Source: Json{
	"Id": "StockTradingStateMachine",
},
}

var StockBuyerFunction = serverless.Function{
	CodeUri: "functions/stock_buyer/",
	Handler: "app.lambda_handler",
	Runtime: "python3.12",
}

var StockCheckerFunction = serverless.Function{
	CodeUri: "functions/stock_checker/",
	Handler: "app.lambda_handler",
	Runtime: "python3.12",
}

var StockSellerFunction = serverless.Function{
	CodeUri: "functions/stock_seller/",
	Handler: "app.lambda_handler",
	Runtime: "python3.12",
}

var TransactionTablePrimaryKey = serverless.SimpleTable_PrimaryKey{
	Name: "Id",
	Type_: "String",
}

var TransactionTable = serverless.SimpleTable{
	PrimaryKey: &TransactionTablePrimaryKey,
	ProvisionedThroughput: Json{
	"ReadCapacityUnits": 1,
	"WriteCapacityUnits": 1,
},
}

var StockTradingStateMachine = serverless.StateMachine{
	DefinitionSubstitutions: Json{
	"DDBPutItem": Sub{String: "arn:${AWS::Partition}:states:::dynamodb:putItem"},
	"DDBTable": TransactionTable,
	"StockBuyerFunctionArn": StockBuyerFunction.Arn,
	"StockCheckerFunctionArn": StockCheckerFunction.Arn,
	"StockSellerFunctionArn": StockSellerFunction.Arn,
},
	DefinitionUri: "statemachine/stock_trader.asl.json",
	Events: Json{
	"HourlyTradingSchedule": Json{
	"Properties": Json{
	"Description": "Schedule to run the stock trading state machine every hour",
	"Enabled": false,
	"Schedule": "rate(1 hour)",
},
	"Type": "Schedule",
},
},
	Policies: []any{Json{
	"CloudWatchPutMetricPolicy": Json{},
}},
}
