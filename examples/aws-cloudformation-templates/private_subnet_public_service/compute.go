// Package private_subnet_public_service contains CloudFormation resources.
// Compute resources: EC2, Lambda, ECS, etc.
//
// Generated by wetwire-aws import.
package private_subnet_public_service

import (
	"github.com/lex00/cloudformation-schema-go/enums"
	. "github.com/lex00/wetwire-aws-go/intrinsics"
	"github.com/lex00/wetwire-aws-go/resources/ecs"
)

var TaskDefinitionContainerDefinition1PortMapping1 = ecs.TaskDefinition_PortMapping{
	ContainerPort: ContainerPort,
}

var TaskDefinitionContainerDefinition1 = ecs.TaskDefinition_ContainerDefinition{
	Cpu: ContainerCpu,
	Essential: true,
	Image: ImageUrl,
	Memory: ContainerMemory,
	Name: ServiceName,
	PortMappings: List(TaskDefinitionContainerDefinition1PortMapping1),
}

var TaskDefinition = ecs.TaskDefinition{
	ContainerDefinitions: List(TaskDefinitionContainerDefinition1),
	Cpu: ContainerCpu,
	ExecutionRoleArn: ImportValue{Join{":", []any{
	StackName,
	"ECSTaskExecutionRole",
}}},
	Family: ServiceName,
	Memory: ContainerMemory,
	NetworkMode: enums.EcsNetworkModeAwsvpc,
	RequiresCompatibilities: []any{"FARGATE"},
	TaskRoleArn: If{"HasCustomRole", Role, AWS_NO_VALUE},
}

var ServiceNetworkConfigurationAwsvpcConfiguration = &ecs.Service_AwsVpcConfiguration{
	AssignPublicIp: "ENABLED",
	SecurityGroups: []any{ImportValue{Join{":", []any{
	StackName,
	"FargateContainerSecurityGroup",
}}}},
	Subnets: []any{ImportValue{Join{":", []any{
	StackName,
	"PrivateSubnetOne",
}}}, ImportValue{Join{":", []any{
	StackName,
	"PrivateSubnetTwo",
}}}},
}

var ServiceNetworkConfiguration = &ecs.Service_NetworkConfiguration{
	AwsvpcConfiguration: ServiceNetworkConfigurationAwsvpcConfiguration,
}

var ServiceLoadBalancer1 = ecs.Service_LoadBalancer{
	ContainerName: ServiceName,
	ContainerPort: ContainerPort,
	TargetGroupArn: TargetGroup,
}

var ServiceDeploymentConfiguration = &ecs.Service_DeploymentConfiguration{
	MaximumPercent: 200,
	MinimumHealthyPercent: 75,
}

var Service = ecs.Service{
	Cluster: ImportValue{Join{":", []any{
	StackName,
	"ClusterName",
}}},
	DeploymentConfiguration: ServiceDeploymentConfiguration,
	DesiredCount: DesiredCount,
	LaunchType: enums.EcsLaunchTypeFargate,
	LoadBalancers: List(ServiceLoadBalancer1),
	NetworkConfiguration: ServiceNetworkConfiguration,
	ServiceName: ServiceName,
	TaskDefinition: TaskDefinition,
}
