// Package dmsauroratos3fullloadandongoingreplication contains CloudFormation resources.
// Main resources
//
// Generated by wetwire-aws import.
package dmsauroratos3fullloadandongoingreplication

import (
	"github.com/lex00/wetwire-aws-go/resources/dms"
)

var AuroraSourceEndpoint = dms.Endpoint{
	EndpointType: "source",
	EngineName: "AURORA",
	Password: "{{resolve:secretsmanager:aurora-source-enpoint-password:SecretString:password}}",
	Port: 3306,
	ServerName: AuroraCluster.Endpoint.Address,
	Username: "admin",
}

var DMSReplicationSubnetGroup = dms.ReplicationSubnetGroup{
	ReplicationSubnetGroupDescription: "Subnets available for DMS",
	SubnetIds: []any{DBSubnet1, DBSubnet2},
}

var DMSReplicationInstance = dms.ReplicationInstance{
	AvailabilityZone: DBSubnet1.AvailabilityZone,
	PubliclyAccessible: false,
	ReplicationInstanceClass: "dms.t3.medium",
	ReplicationInstanceIdentifier: "aurora-s3-repinstance-sampledb",
	ReplicationSubnetGroupIdentifier: DMSReplicationSubnetGroup,
	VpcSecurityGroupIds: []any{DMSSecurityGroup},
}

var DMSReplicationTask = dms.ReplicationTask{
	MigrationType: "full-load-and-cdc",
	ReplicationInstanceArn: DMSReplicationInstance,
	ReplicationTaskSettings: "{ \"Logging\" : { \"EnableLogging\" : true, \"LogComponents\": [ { \"Id\" : \"SOURCE_UNLOAD\", \"Severity\" : \"LOGGER_SEVERITY_DEFAULT\" }, { \"Id\" : \"SOURCE_CAPTURE\", \"Severity\" : \"LOGGER_SEVERITY_DEFAULT\" }, { \"Id\" : \"TARGET_LOAD\", \"Severity\" : \"LOGGER_SEVERITY_DEFAULT\" }, { \"Id\" : \"TARGET_APPLY\", \"Severity\" : \"LOGGER_SEVERITY_DEFAULT\" } ] } }",
	SourceEndpointArn: AuroraSourceEndpoint,
	TableMappings: "{ \"rules\": [ { \"rule-type\" : \"selection\", \"rule-id\" : \"1\", \"rule-name\" : \"1\", \"object-locator\" : { \"schema-name\" : \"dms_sample\", \"table-name\" : \"%\" }, \"rule-action\" : \"include\" } ] }",
	TargetEndpointArn: S3TargetEndpoint,
}

var S3TargetEndpointS3Settings = dms.Endpoint_S3Settings{
	BucketName: S3Bucket,
	ServiceAccessRoleArn: S3TargetDMSRole.Arn,
}

var S3TargetEndpoint = dms.Endpoint{
	EndpointType: "target",
	EngineName: "S3",
	ExtraConnectionAttributes: "addColumnName=true",
	S3Settings: &S3TargetEndpointS3Settings,
}
