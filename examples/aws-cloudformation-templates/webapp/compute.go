// Package webapp contains CloudFormation resources.
// Compute resources: EC2, Lambda, ECS, etc.
//
// Generated by wetwire-aws import.
package webapp

import (
	"github.com/lex00/cloudformation-schema-go/enums"
	. "github.com/lex00/wetwire-aws-go/intrinsics"
	"github.com/lex00/wetwire-aws-go/resources/lambda"
)

var JwtResourceHandlerEnvironment = lambda.Function_Environment{
	Variables: map[string]any{"COGNITO_APP_CLIENT_ID": CognitoClient, "COGNITO_DOMAIN_PREFIX": AppName, "COGNITO_POOL_ID": CognitoUserPool, "COGNITO_REDIRECT_URI": Sub{String: "https://${SiteDistribution.DomainName}/index.html"}, "COGNITO_REGION": "us-east-1"},
}

var JwtResourceHandlerCode = lambda.Function_Code{
	S3Bucket: "rain-artifacts-207567786752-us-east-1",
	S3Key: "15d7c92b571beed29cf6c012a96022482eee1df1b477ad528ddc03a4be52c076",
}

var JwtResourceHandler = lambda.Function{
	Code: JwtResourceHandlerCode,
	Environment: JwtResourceHandlerEnvironment,
	FunctionName: Sub{String: "${AppName}-jwt-handler"},
	Handler: "bootstrap",
	Role: JwtResourceHandlerRole.Arn,
	Runtime: enums.LambdaRuntimeProvidedAl2023,
}

var JwtResourcePermission = lambda.Permission{
	Action: "lambda:InvokeFunction",
	FunctionName: JwtResourceHandler.Arn,
	Principal: "apigateway.amazonaws.com",
	SourceArn: Sub{String: "arn:${AWS::Partition}:execute-api:${AWS::Region}:${AWS::AccountId}:${RestApi}/*/*/*"},
}

var JwtResourceRootPermission = lambda.Permission{
	Action: "lambda:InvokeFunction",
	FunctionName: JwtResourceHandler.Arn,
	Principal: "apigateway.amazonaws.com",
	SourceArn: Sub{String: "arn:${AWS::Partition}:execute-api:${AWS::Region}:${AWS::AccountId}:${RestApi}/*/*/"},
}

var TestResourceHandlerEnvironment = lambda.Function_Environment{
	Variables: map[string]any{"TABLE_NAME": TestTable},
}

var TestResourceHandlerCode = lambda.Function_Code{
	S3Bucket: LambdaCodeS3Bucket,
	S3Key: LambdaCodeS3Key,
}

var TestResourceHandler = lambda.Function{
	Code: TestResourceHandlerCode,
	Environment: TestResourceHandlerEnvironment,
	FunctionName: Sub{String: "${AppName}-test-handler"},
	Handler: "bootstrap",
	Role: TestResourceHandlerRole.Arn,
	Runtime: enums.LambdaRuntimeProvidedAl2023,
}

var TestResourcePermission = lambda.Permission{
	Action: "lambda:InvokeFunction",
	FunctionName: TestResourceHandler.Arn,
	Principal: "apigateway.amazonaws.com",
	SourceArn: Sub{String: "arn:${AWS::Partition}:execute-api:${AWS::Region}:${AWS::AccountId}:${RestApi}/*/*/*"},
}

var TestResourceRootPermission = lambda.Permission{
	Action: "lambda:InvokeFunction",
	FunctionName: TestResourceHandler.Arn,
	Principal: "apigateway.amazonaws.com",
	SourceArn: Sub{String: "arn:${AWS::Partition}:execute-api:${AWS::Region}:${AWS::AccountId}:${RestApi}/*/*/"},
}
