// Package source contains CloudFormation resources.
// Security resources: IAM, Cognito, KMS, etc.
//
// Generated by wetwire-aws import.
package source

import (
	. "github.com/lex00/wetwire-aws-go/intrinsics"
	"github.com/lex00/wetwire-aws-go/resources/iam"
	"github.com/lex00/wetwire-aws-go/resources/kms"
)

var KmsKeyKeyPolicy = PolicyDocument{
	Statement: Any(KmsKeyKeyPolicyStatement0),
	Version: "2012-10-17",
}

var KmsKeyKeyPolicyStatement0 = PolicyStatement{
	Action: "kms:*",
	Effect: "Allow",
	Principal: AWSPrincipal{Sub{String: "arn:${AWS::Partition}:iam::${AWS::AccountId}:root"}},
	Resource: "*",
	Sid: "Allow source account access to KMS key in source account",
}

var KmsKey = kms.Key{
	EnableKeyRotation: true,
	KeyPolicy: KmsKeyKeyPolicy,
}

var KmsKeyAlias = kms.Alias{
	AliasName: Sub{String: "alias/${AWS::StackName}-${AWS::AccountId}-kms-key"},
	TargetKeyId: KmsKey,
}

var ReplicationRolePolicy1PolicyDocument = PolicyDocument{
	Statement: Any(ReplicationRolePolicy1PolicyDocumentStatement0, ReplicationRolePolicy1PolicyDocumentStatement1, ReplicationRolePolicy1PolicyDocumentStatement2, ReplicationRolePolicy1PolicyDocumentStatement3),
	Version: "2012-10-17",
}

var ReplicationRolePolicy1PolicyDocumentStatement3 = PolicyStatement{
	Action: "kms:Encrypt",
	Condition: Json{StringEquals: Json{"kms:RequestAlias": Sub{String: "alias/${AWS::StackName}-${AccountIdDestination}-kms-key"}}},
	Effect: "Allow",
	Resource: "*",
	Sid: "AllowKmsEncryptOnDestinationKey",
}

var ReplicationRolePolicy1PolicyDocumentStatement2 = PolicyStatement{
	Action: "kms:Decrypt",
	Effect: "Allow",
	Resource: KmsKey.Arn,
	Sid: "AllowKmsDecryptOnSourceKey",
}

var ReplicationRolePolicy1PolicyDocumentStatement1 = PolicyStatement{
	Action: Any("s3:ReplicateObject", "s3:ReplicateDelete", "s3:ReplicateTags", "s3:GetObjectVersionTagging", "s3:ObjectOwnerOverrideToBucketOwner"),
	Effect: "Allow",
	Resource: Any(Sub{String: "arn:${AWS::Partition}:s3:::${AWS::StackName}-${AccountIdDestination}-bucket/*"}, Sub{String: "arn:${AWS::Partition}:s3:::${AWS::StackName}-${AccountIdDestination}-bucket"}),
	Sid: "AllowActionsOnDestinationBucket",
}

var ReplicationRolePolicy1PolicyDocumentStatement0 = PolicyStatement{
	Action: Any("s3:ListBucket", "s3:GetReplicationConfiguration", "s3:GetObjectVersionForReplication", "s3:GetObjectVersionAcl"),
	Effect: "Allow",
	Resource: Any(Sub{String: "arn:${AWS::Partition}:s3:::${AWS::StackName}-${AWS::AccountId}-bucket/*"}, Sub{String: "arn:${AWS::Partition}:s3:::${AWS::StackName}-${AWS::AccountId}-bucket"}),
	Sid: "AllowActionsOnSourceBucket",
}

var ReplicationRolePolicy1 = iam.Role_Policy{
	PolicyDocument: ReplicationRolePolicy1PolicyDocument,
	PolicyName: Sub{String: "${AWS::StackName}-${AccountIdDestination}-role-policy"},
}

var ReplicationRoleAssumeRolePolicyDocument = PolicyDocument{
	Statement: Any(ReplicationRoleAssumeRolePolicyDocumentStatement0),
	Version: "2012-10-17",
}

var ReplicationRoleAssumeRolePolicyDocumentStatement0 = PolicyStatement{
	Action: "sts:AssumeRole",
	Effect: "Allow",
	Principal: ServicePrincipal{"s3.amazonaws.com"},
}

var ReplicationRole = iam.Role{
	AssumeRolePolicyDocument: ReplicationRoleAssumeRolePolicyDocument,
	Description: "IAM Role used by S3 bucket replication",
	Policies: List(ReplicationRolePolicy1),
	RoleName: Sub{String: "${AWS::StackName}-${AccountIdDestination}-role"},
}
