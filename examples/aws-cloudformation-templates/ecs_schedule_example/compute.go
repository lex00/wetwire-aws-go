// Package ecs_schedule_example contains CloudFormation resources.
// Compute resources: EC2, Lambda, ECS, etc.
//
// Generated by wetwire-aws import.
package ecs_schedule_example

import (
	. "github.com/lex00/wetwire-aws-go/intrinsics"
	"github.com/lex00/wetwire-aws-go/resources/autoscaling"
	"github.com/lex00/wetwire-aws-go/resources/ecs"
)

var ECSCluster = ecs.Cluster{
}

var ContainerInstances = autoscaling.LaunchConfiguration{
	IamInstanceProfile: EC2InstanceProfile,
	ImageId: LatestAmiId,
	InstanceType: InstanceType,
	KeyName: KeyName,
	SecurityGroups: Any(EcsSecurityGroup),
	UserData: Base64{Sub{String: "#!/bin/bash -xe\necho ECS_CLUSTER=${ECSCluster} >> /etc/ecs/ecs.config\nyum install -y aws-cfn-bootstrap\n/opt/aws/bin/cfn-signal -e $? --stack ${AWS::StackName} \\\n    --resource ECSAutoScalingGroup \\\n    --region ${AWS::Region}\n"}},
}

var ECSAutoScalingGroup = autoscaling.AutoScalingGroup{
	DesiredCapacity: DesiredCapacity,
	LaunchConfigurationName: ContainerInstances,
	MaxSize: MaxSize,
	MinSize: "1",
	VPCZoneIdentifier: SubnetId,
}

var ServiceLoadBalancer1 = ecs.Service_LoadBalancer{
	ContainerName: "simple-app",
	ContainerPort: "80",
	TargetGroupArn: ECSTG,
}

var Service = ecs.Service{
	Cluster: ECSCluster,
	DesiredCount: "1",
	LoadBalancers: List(ServiceLoadBalancer1),
	Role: ECSServiceRole,
	TaskDefinition: TaskDefinition,
}

var TaskDefinitionContainerDefinitionBusyboxVolumesFrom1 = ecs.TaskDefinition_VolumeFrom{
	SourceContainer: "simple-app",
}

var TaskDefinitionContainerDefinitionBusyboxLogConfiguration = ecs.Service_LogConfiguration{
	LogDriver: "awslogs",
	Options: map[string]any{"awslogs-group": CloudwatchLogsGroup, "awslogs-region": AWS_REGION, "awslogs-stream-prefix": "ecs-demo-app"},
}

var TaskDefinitionContainerDefinitionSimpleNegappPortMapping1 = ecs.TaskDefinition_PortMapping{
	ContainerPort: 80,
}

var TaskDefinitionContainerDefinitionSimpleNegappMountPoint1 = ecs.TaskDefinition_MountPoint{
	ContainerPath: "/usr/local/apache2/htdocs",
	SourceVolume: "my-vol",
}

var TaskDefinitionContainerDefinitionSimpleNegappLogConfiguration = ecs.Service_LogConfiguration{
	LogDriver: "awslogs",
	Options: map[string]any{"awslogs-group": CloudwatchLogsGroup, "awslogs-region": AWS_REGION, "awslogs-stream-prefix": "ecs-demo-app"},
}

var TaskDefinitionVolumeMyNegvol = ecs.TaskDefinition_Volume{
	Name: "my-vol",
}

var TaskDefinitionContainerDefinitionBusybox = ecs.TaskDefinition_ContainerDefinition{
	Command: Any("/bin/sh -c \"while true; do echo '<html> <head> <title>Amazon ECS Sample App</title> <style>body {margin-top: 40px; background-color: #333;} </style> </head><body> <div style=color:white;text-align:center> <h1>Amazon ECS Sample App</h1> <h2>Congratulations!</h2> <p>Your application is now running on a container in Amazon ECS.</p>' > top; /bin/date > date ; echo '</div></body></html>' > bottom; cat top date bottom > /usr/local/apache2/htdocs/index.html ; sleep 1; done\""),
	Cpu: 10,
	EntryPoint: Any("sh", "-c"),
	Essential: false,
	Image: "busybox",
	LogConfiguration: &TaskDefinitionContainerDefinitionBusyboxLogConfiguration,
	Memory: 200,
	Name: "busybox",
	VolumesFrom: List(TaskDefinitionContainerDefinitionBusyboxVolumesFrom1),
}

var TaskDefinitionContainerDefinitionSimpleNegapp = ecs.TaskDefinition_ContainerDefinition{
	Cpu: "10",
	Essential: "true",
	Image: "httpd:2.4",
	LogConfiguration: &TaskDefinitionContainerDefinitionSimpleNegappLogConfiguration,
	Memory: "300",
	MountPoints: List(TaskDefinitionContainerDefinitionSimpleNegappMountPoint1),
	Name: "simple-app",
	PortMappings: List(TaskDefinitionContainerDefinitionSimpleNegappPortMapping1),
}

var TaskDefinition = ecs.TaskDefinition{
	ContainerDefinitions: List(TaskDefinitionContainerDefinitionSimpleNegapp, TaskDefinitionContainerDefinitionBusybox),
	Family: Join{Delimiter: "", Values: []any{
	AWS_STACK_NAME,
	"-ecs-demo-app",
}},
	Volumes: List(TaskDefinitionVolumeMyNegvol),
}
