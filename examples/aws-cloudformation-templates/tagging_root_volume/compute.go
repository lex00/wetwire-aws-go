// Package tagging_root_volume contains CloudFormation resources.
// Compute resources: EC2, Lambda, ECS, etc.
//
// Generated by wetwire-aws import.
package tagging_root_volume

import (
	. "github.com/lex00/wetwire-aws-go/intrinsics"
	"github.com/lex00/wetwire-aws-go/resources/ec2"
)

var LinuxInstanceBlockDeviceMappingDevsdmEbs = ec2.Instance_Ebs{
	DeleteOnTermination: "true",
	Iops: "200",
	VolumeSize: "10",
	VolumeType: "io1",
}

var LinuxInstanceTagName = Tag{
	Key: "Name",
	Value: AWS_STACK_NAME,
}

var LinuxInstanceBlockDeviceMappingDevsdm = ec2.Instance_BlockDeviceMapping{
	DeviceName: "/dev/sdm",
	Ebs: &LinuxInstanceBlockDeviceMappingDevsdmEbs,
}

var LinuxInstance = ec2.Instance{
	AvailabilityZone: InstanceAZ,
	BlockDeviceMappings: List(LinuxInstanceBlockDeviceMappingDevsdm),
	IamInstanceProfile: InstanceProfile,
	ImageId: LinuxAMIID,
	InstanceType: InstanceType,
	KeyName: KeyName,
	SubnetId: SubnetId,
	Tags: []any{LinuxInstanceTagName},
	UserData: Base64{"AWS_AVAIL_ZONE=$(curl http://169.254.169.254/latest/meta-data/placement/availability-zone)\nAWS_REGION=\"`echo \\\"$AWS_AVAIL_ZONE\\\" | sed 's/[a-z]$//'`\"\nAWS_INSTANCE_ID=$(curl http://169.254.169.254/latest/meta-data/instance-id)\nROOT_VOLUME_IDS=$(aws ec2 describe-instances --region $AWS_REGION --instance-id $AWS_INSTANCE_ID --output text --query Reservations[0].Instances[0].BlockDeviceMappings[0].Ebs.VolumeId)\naws ec2 create-tags --resources $ROOT_VOLUME_IDS --region $AWS_REGION --tags Key=MyRootTag,Value=MyRootVolumesValue\n"},
}

var WindowsInstanceBlockDeviceMappingDevsdmEbs = ec2.Instance_Ebs{
	DeleteOnTermination: "true",
	Iops: "200",
	VolumeSize: "10",
	VolumeType: "io1",
}

var WindowsInstanceTagName = Tag{
	Key: "Name",
	Value: AWS_STACK_NAME,
}

var WindowsInstanceBlockDeviceMappingDevsdm = ec2.Instance_BlockDeviceMapping{
	DeviceName: "/dev/sdm",
	Ebs: &WindowsInstanceBlockDeviceMappingDevsdmEbs,
}

var WindowsInstance = ec2.Instance{
	AvailabilityZone: InstanceAZ,
	BlockDeviceMappings: List(WindowsInstanceBlockDeviceMappingDevsdm),
	IamInstanceProfile: InstanceProfile,
	ImageId: WindowsAMIID,
	InstanceType: InstanceType,
	KeyName: KeyName,
	SubnetId: SubnetId,
	Tags: []any{WindowsInstanceTagName},
	UserData: Base64{"<powershell>\n  $AWS_AVAIL_ZONE=(curl http://169.254.169.254/latest/meta-data/placement/availability-zone).Content\n  $AWS_REGION=$AWS_AVAIL_ZONE.Substring(0,$AWS_AVAIL_ZONE.length-1)\n  $AWS_INSTANCE_ID=(curl http://169.254.169.254/latest/meta-data/instance-id).Content\n  $ROOT_VOLUME_IDS=((Get-EC2Instance -Region $AWS_REGION -InstanceId $AWS_INSTANCE_ID).Instances.BlockDeviceMappings | where-object DeviceName -match '/dev/sda1').Ebs.VolumeId\n  $tag = New-Object Amazon.EC2.Model.Tag\n  $tag.key = \"MyRootTag\"\n  $tag.value = \"MyRootVolumesValue\"\n  New-EC2Tag -Resource $ROOT_VOLUME_IDS -Region $AWS_REGION -Tag $tag\n</powershell>\n"},
}
