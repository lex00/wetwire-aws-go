// Package autoscalingscheduledaction contains CloudFormation resources.
// Compute resources: EC2, Lambda, ECS, etc.
//
// Generated by wetwire-aws import.
package autoscalingscheduledaction

import (
	. "github.com/lex00/wetwire-aws-go/intrinsics"
	"github.com/lex00/wetwire-aws-go/resources/autoscaling"
)

var LaunchConfig = autoscaling.LaunchConfiguration{
	ImageId: FindInMap{"AWSRegionArch2AMI", AWS_REGION, FindInMap{"AWSInstanceType2Arch", InstanceType, "Arch"}},
	InstanceType: InstanceType,
	KeyName: KeyName,
	SecurityGroups: []any{InstanceSecurityGroup},
	UserData: Base64{Join{"", []any{
	"#!/bin/bash -xe ",
	"yum update -y aws-cfn-bootstrap ",
	"/opt/aws/bin/cfn-init -v ",
	"         --stack ",
	AWS_STACK_NAME,
	"         --resource LaunchConfig ",
	"         --region ",
	AWS_REGION,
	" ",
	"/opt/aws/bin/cfn-signal -e $? ",
	"         --stack ",
	AWS_STACK_NAME,
	"         --resource WebServerGroup ",
	"         --region ",
	AWS_REGION,
	" ",
}}},
}

var WebServerGroup = autoscaling.AutoScalingGroup{
	AvailabilityZones: GetAZs{},
	LaunchConfigurationName: LaunchConfig,
	LoadBalancerNames: []any{ElasticLoadBalancer},
	MaxSize: 5,
	MinSize: 2,
}

var ScheduledActionDown = autoscaling.ScheduledAction{
	AutoScalingGroupName: WebServerGroup,
	MaxSize: "1",
	MinSize: "1",
	Recurrence: "0 19 * * *",
}

var ScheduledActionUp = autoscaling.ScheduledAction{
	AutoScalingGroupName: WebServerGroup,
	MaxSize: "10",
	MinSize: "5",
	Recurrence: "0 7 * * *",
}
