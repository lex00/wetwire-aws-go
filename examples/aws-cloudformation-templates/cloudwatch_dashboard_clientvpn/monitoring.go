// Package cloudwatch_dashboard_clientvpn contains CloudFormation resources.
// Monitoring resources: CloudWatch, Logs, etc.
//
// Generated by wetwire-aws import.
package cloudwatch_dashboard_clientvpn

import (
	. "github.com/lex00/wetwire-aws-go/intrinsics"
	"github.com/lex00/wetwire-aws-go/resources/cloudwatch"
	"github.com/lex00/wetwire-aws-go/resources/logs"
)

var ADSAMLAuthDistinctUsers = logs.QueryDefinition{
	Name: Sub{String: "${Folder}/AD or SAML Auth Distinct Users"},
	QueryString: "fields @timestamp, `client-vpn-endpoint-id`, `username` \n| sort @timestamp asc \n| stats count(*) as connection_count, \n  latest(`client-vpn-endpoint-id`) as client_vpn_endpoint_id \nby `username`\n",
}

var ADSAMLAuthDistinctUsersConnectionDuration = logs.QueryDefinition{
	Name: Sub{String: "${Folder}/AD or SAML Auth Distinct Users Connection Duration"},
	QueryString: "fields @timestamp, `client-vpn-endpoint-id`, `username`, `ingress-bytes`, `egress-bytes`, `connection-start-time`, `connection-end-time`, `connection-duration-seconds` \n| sort @timestamp asc \n| filter `ingress-bytes` > 0 OR `egress-bytes` > 0 \n| stats count(*) as connection_count, \n  sum(`connection-duration-seconds`/60) as total_connection_time_minutes, \n  sum(`ingress-bytes`) as total_ingress_bytes, \n  sum(`egress-bytes`) as total_egress_bytes, \n  latest(`client-vpn-endpoint-id`) as client_vpn_endpoint_id \nby `username` \n| sort by total_ingress_bytes desc, total_egress_bytes desc\n",
}

var ADSAMLAuthTotalUsageReport = logs.QueryDefinition{
	Name: Sub{String: "${Folder}/AD or SAML Auth Total Usage Report"},
	QueryString: "fields @timestamp, `client-vpn-endpoint-id`, `username`, `ingress-bytes`, `egress-bytes`, `connection-start-time`, `connection-end-time`, `connection-duration-seconds` \n| sort @timestamp asc \n| filter `ingress-bytes` > 0 OR `egress-bytes` > 0 \n| fields @timestamp, `client-vpn-endpoint-id`, `username`, `ingress-bytes`, `egress-bytes`, `connection-start-time`, `connection-end-time`, `connection-duration-seconds`, (`connection-duration-seconds`/60) as connection_time_minutes \n| sort by `ingress-bytes` desc, `egress-bytes` desc\n",
}

var ADSAMLAuthUsersConnectionDuration = logs.QueryDefinition{
	Name: Sub{String: "${Folder}/AD or SAML Auth Users Connection Duration"},
	QueryString: "fields @timestamp, `client-vpn-endpoint-id`, `username`, `ingress-bytes`, `egress-bytes`, `connection-start-time`, `connection-end-time`, `connection-duration-seconds` \n| sort @timestamp asc \n| filter `ingress-bytes` > 0 OR `egress-bytes` > 0 \n| stats count(*) as connection_count, \n  sum(`connection-duration-seconds`/60) as total_connection_time_minutes \nby `username` \n| sort by total_connection_time_minutes desc\n",
}

var Dashboard = cloudwatch.Dashboard{
	DashboardBody: SubWithMap{String: "{\n  \"widgets\": [\n    {\n      \"type\": \"log\",\n      \"x\": 0,\n      \"y\": 0,\n      \"width\": 24,\n      \"height\": 6,\n      \"properties\": {\n        \"query\": \"SOURCE '${ClientVPNLogGroup}' | fields @timestamp, `client-vpn-endpoint-id`, `ingress-bytes`, `egress-bytes`, `connection-duration-seconds`, `username`, `common-name` | sort @timestamp asc | filter `ingress-bytes` > 0 OR `egress-bytes` > 0 | stats count(*) as connection_count, min(@timestamp) as earliest_timestamp, max(@timestamp) as latest_timestamp, sum(`ingress-bytes`)/1048576 as total_ingress_MB, sum(`egress-bytes`)/1048576 as total_egress_MB, sum((`connection-duration-seconds`/60)/60) as total_connection_time_hours, count_distinct(username) as unique_saml_ad_users, count_distinct(`common-name`) as unique_mutual_auth_names by `client-vpn-endpoint-id` | sort by total_ingress_MB desc, total_egress_MB desc\",\n        \"region\": \"${AWS::Region}\",\n        \"title\": \"Total Usage per Client VPN Endpoint\",\n        \"view\": \"table\"\n      }\n    },\n    {\n      \"type\": \"log\",\n      \"x\": 0,\n      \"y\": 6,\n      \"width\": 24,\n      \"height\": 6,\n      \"properties\": {\n        \"query\": \"SOURCE '${ClientVPNLogGroup}' | fields @timestamp, `client-vpn-endpoint-id`, `username`, `ingress-bytes`, `egress-bytes`, `connection-start-time`, `connection-end-time`, `connection-duration-seconds` | sort @timestamp asc | filter `ingress-bytes` > 0 OR `egress-bytes` > 0 | fields @timestamp, `client-vpn-endpoint-id`, `username`, `ingress-bytes`, `egress-bytes`, `connection-start-time`, `connection-end-time`, `connection-duration-seconds`, (`connection-duration-seconds`/60) as connection_time_minutes | sort by `ingress-bytes` desc, `egress-bytes` desc\",\n        \"region\": \"${AWS::Region}\",\n        \"title\": \"AD or SAML Auth Total Usage Report\",\n        \"view\": \"table\"\n      }\n    },\n    {\n      \"type\": \"log\",\n      \"x\": 0,\n      \"y\": 12,\n      \"width\": 24,\n      \"height\": 6,\n      \"properties\": {\n        \"query\": \"SOURCE '${ClientVPNLogGroup}' | fields @timestamp, `client-vpn-endpoint-id`, `username`, `ingress-bytes`, `egress-bytes`, `connection-start-time`, `connection-end-time`, `connection-duration-seconds` | sort @timestamp asc | filter `ingress-bytes` > 0 OR `egress-bytes` > 0 | stats count(*) as connection_count, sum(`connection-duration-seconds`/60) as total_connection_time_minutes, sum(`ingress-bytes`) as total_ingress_bytes, sum(`egress-bytes`) as total_egress_bytes, latest(`client-vpn-endpoint-id`) as client_vpn_endpoint_id by `username` | sort by total_ingress_bytes desc, total_egress_bytes desc\",\n        \"region\": \"${AWS::Region}\",\n        \"title\": \"AD or SAML Auth Distinct Users Connection Duration\",\n        \"view\": \"table\"\n      }\n    },\n    {\n      \"type\": \"log\",\n      \"x\": 0,\n      \"y\": 18,\n      \"width\": 24,\n      \"height\": 6,\n      \"properties\": {\n        \"query\": \"SOURCE '${ClientVPNLogGroup}' | fields @timestamp, `client-vpn-endpoint-id`, `username` | sort @timestamp asc | stats count(*) as connection_count, latest(`client-vpn-endpoint-id`) as client_vpn_endpoint_id by `username`\",\n        \"region\": \"${AWS::Region}\",\n        \"title\": \"AD or SAML Auth Distinct Users\",\n        \"view\": \"table\"\n      }\n    },\n    {\n      \"type\": \"log\",\n      \"x\": 0,\n      \"y\": 24,\n      \"width\": 24,\n      \"height\": 6,\n      \"properties\": {\n        \"query\": \"SOURCE '${ClientVPNLogGroup}' | fields @timestamp, `client-vpn-endpoint-id`, `username`, `ingress-bytes`, `egress-bytes`, `connection-start-time`, `connection-end-time`, `connection-duration-seconds` | sort @timestamp asc | filter `ingress-bytes` > 0 OR `egress-bytes` > 0 | stats count(*) as connection_count, sum(`connection-duration-seconds`/60) as total_connection_time_minutes by `username` | sort by total_connection_time_minutes desc\",\n        \"region\": \"${AWS::Region}\",\n        \"title\": \"AD or SAML Auth Users Connection Duration\",\n        \"view\": \"table\"\n      }\n    },\n    {\n      \"type\": \"log\",\n      \"x\": 0,\n      \"y\": 30,\n      \"width\": 24,\n      \"height\": 6,\n      \"properties\": {\n        \"query\": \"SOURCE '${ClientVPNLogGroup}' | fields @timestamp, `client-vpn-endpoint-id`, `common-name`, `ingress-bytes`, `egress-bytes`, `connection-start-time`, `connection-end-time`, `connection-duration-seconds` | sort @timestamp asc | filter `ingress-bytes` > 0 OR `egress-bytes` > 0 | fields @timestamp, `client-vpn-endpoint-id`, `common-name`, `ingress-bytes`, `egress-bytes`, `connection-start-time`, `connection-end-time`, `connection-duration-seconds`, (`connection-duration-seconds`/60) as connection_time_minutes | sort by `ingress-bytes` desc, `egress-bytes` desc\",\n        \"region\": \"${AWS::Region}\",\n        \"title\": \"Mutual Auth Total Usage Report\",\n        \"view\": \"table\"\n      }\n    },\n    {\n      \"type\": \"log\",\n      \"x\": 0,\n      \"y\": 36,\n      \"width\": 24,\n      \"height\": 6,\n      \"properties\": {\n        \"query\": \"SOURCE '${ClientVPNLogGroup}' | fields @timestamp, `client-vpn-endpoint-id`, `common-name`, `ingress-bytes`, `egress-bytes`, `connection-duration-seconds` | sort @timestamp asc | filter `ingress-bytes` > 0 OR `egress-bytes` > 0 | stats count(*) as connection_count, sum(`connection-duration-seconds`/60) as total_connection_time_minutes, sum(`ingress-bytes`) as total_ingress_bytes, sum(`egress-bytes`) as total_egress_bytes, latest(`client-vpn-endpoint-id`) as client_vpn_endpoint_id by `common-name` | sort by total_ingress_bytes desc, total_egress_bytes desc\",\n        \"region\": \"${AWS::Region}\",\n        \"title\": \"Mutual Auth Users Duration\",\n        \"view\": \"table\"\n      }\n    },\n    {\n      \"type\": \"log\",\n      \"x\": 0,\n      \"y\": 42,\n      \"width\": 24,\n      \"height\": 6,\n      \"properties\": {\n        \"query\": \"SOURCE '${ClientVPNLogGroup}' | fields @timestamp, `client-vpn-endpoint-id`, `common-name` | sort @timestamp asc | stats count(*) as connection_count, latest(`client-vpn-endpoint-id`) as client_vpn_endpoint_id by `common-name`\",\n        \"region\": \"${AWS::Region}\",\n        \"title\": \"Mutual Auth Distinct Users\",\n        \"view\": \"table\"\n      }\n    },\n    {\n      \"type\": \"log\",\n      \"x\": 0,\n      \"y\": 48,\n      \"width\": 24,\n      \"height\": 6,\n      \"properties\": {\n        \"query\": \"SOURCE '${ClientVPNLogGroup}' | fields @timestamp, `client-vpn-endpoint-id`, `username`, `common-name`, `ingress-bytes`, `egress-bytes`, `connection-start-time`, `connection-end-time`, `connection-duration-seconds` | sort @timestamp asc | filter `ingress-bytes` > 0 OR `egress-bytes` > 0 | fields @timestamp, `client-vpn-endpoint-id`, `username`, `common-name`, `ingress-bytes`, `egress-bytes`, `connection-start-time`, `connection-end-time`, `connection-duration-seconds`, (`connection-duration-seconds`/60) as connection_time_minutes | sort by `ingress-bytes` desc, `egress-bytes` desc\",\n        \"region\": \"${AWS::Region}\",\n        \"title\": \"Mix Auth Total Usage Report\",\n        \"view\": \"table\"\n      }\n    },\n    {\n      \"type\": \"log\",\n      \"x\": 0,\n      \"y\": 54,\n      \"width\": 24,\n      \"height\": 6,\n      \"properties\": {\n        \"query\": \"SOURCE '${ClientVPNLogGroup}' | fields @timestamp, `client-vpn-endpoint-id`, `common-name`, `username`, `ingress-bytes`, `egress-bytes`, `connection-start-time`, `connection-end-time`, `connection-duration-seconds` | sort @timestamp asc | filter `ingress-bytes` > 0 OR `egress-bytes` > 0 | stats count(*) as connection_count, sum(`connection-duration-seconds`/60) as total_connection_time_minutes, sum(`ingress-bytes`) as total_ingress_bytes, sum(`egress-bytes`) as total_egress_bytes, latest(`client-vpn-endpoint-id`) as client_vpn_endpoint_id by `common-name`, `username` | sort by total_ingress_bytes desc, total_egress_bytes desc\",\n        \"region\": \"${AWS::Region}\",\n        \"title\": \"Mix Auth Distinct Users Connection Duration\",\n        \"view\": \"table\"\n      }\n    },\n    {\n      \"type\": \"log\",\n      \"x\": 0,\n      \"y\": 60,\n      \"width\": 24,\n      \"height\": 6,\n      \"properties\": {\n        \"query\": \"SOURCE '${ClientVPNLogGroup}' | fields @timestamp, `client-vpn-endpoint-id`, `common-name`, `username` | sort @timestamp asc | stats count(*) as connection_count, latest(`client-vpn-endpoint-id`) as client_vpn_endpoint_id by `username`, `common-name`\",\n        \"region\": \"${AWS::Region}\",\n        \"title\": \"Mix Auth Distinct Users\",\n        \"view\": \"table\"\n      }\n    },\n    {\n      \"type\": \"log\",\n      \"x\": 0,\n      \"y\": 66,\n      \"width\": 24,\n      \"height\": 6,\n      \"properties\": {\n        \"query\": \"SOURCE '${ClientVPNLogGroup}' | fields @timestamp, `client-vpn-endpoint-id`, `common-name`, `username`, `ingress-bytes`, `egress-bytes`, `connection-start-time`, `connection-end-time`, `connection-duration-seconds` | sort @timestamp asc | filter `ingress-bytes` > 0 OR `egress-bytes` > 0 | stats count(*) as connection_count, sum(`connection-duration-seconds`/60) as total_connection_time_minutes by `username`, `common-name` | sort by total_connection_time_minutes desc\",\n        \"region\": \"${AWS::Region}\",\n        \"title\": \"Mix Auth Users Connection Duration\",\n        \"view\": \"table\"\n      }\n    }\n  ]\n}\n", Variables: map[string]any{}},
	DashboardName: Sub{String: "${AWS::Region}-AWS-ClientVPN-Usage-Dashboard"},
}

var MixAuthDistinctUsers = logs.QueryDefinition{
	Name: Sub{String: "${Folder}/Mix Auth Distinct Users"},
	QueryString: "fields @timestamp, `client-vpn-endpoint-id`, `common-name`, `username`\n| sort @timestamp asc\n| stats count(*) as connection_count,\n  latest(`client-vpn-endpoint-id`) as client_vpn_endpoint_id\nby `username`, `common-name`\n",
}

var MixAuthDistinctUsersConnectionDuration = logs.QueryDefinition{
	Name: Sub{String: "${Folder}/Mix Auth Distinct Users Connection Duration"},
	QueryString: "fields @timestamp, `client-vpn-endpoint-id`, `common-name`, `username`, `ingress-bytes`, `egress-bytes`, `connection-start-time`, `connection-end-time`, `connection-duration-seconds` \n| sort @timestamp asc\n| filter `ingress-bytes` > 0 OR `egress-bytes` > 0\n| stats count(*) as connection_count,\n  sum(`connection-duration-seconds`/60) as total_connection_time_minutes,\n  sum(`ingress-bytes`) as total_ingress_bytes,\n  sum(`egress-bytes`) as total_egress_bytes,\n  latest(`client-vpn-endpoint-id`) as client_vpn_endpoint_id\nby `common-name`, `username`\n| sort by total_ingress_bytes desc, total_egress_bytes desc\n",
}

var MixAuthTotalUsageReport = logs.QueryDefinition{
	Name: Sub{String: "${Folder}/Mix Auth Total Usage Report"},
	QueryString: "fields @timestamp, `client-vpn-endpoint-id`, `username`, `common-name`, `ingress-bytes`, `egress-bytes`, `connection-start-time`, `connection-end-time`, `connection-duration-seconds` \n| sort @timestamp asc\n| filter `ingress-bytes` > 0 OR `egress-bytes` > 0\n| fields @timestamp, `client-vpn-endpoint-id`, `username`, `common-name`, `ingress-bytes`, `egress-bytes`, `connection-start-time`, `connection-end-time`, `connection-duration-seconds`, (`connection-duration-seconds`/60) as connection_time_minutes \n| sort by `ingress-bytes` desc, `egress-bytes` desc\n",
}

var MixAuthUsersConnectionDuration = logs.QueryDefinition{
	Name: Sub{String: "${Folder}/Mix Auth Users Connection Duration"},
	QueryString: "fields @timestamp, `client-vpn-endpoint-id`, `common-name`, `username`, `ingress-bytes`, `egress-bytes`, `connection-start-time`, `connection-end-time`, `connection-duration-seconds` \n| sort @timestamp asc \n| filter `ingress-bytes` > 0 OR `egress-bytes` > 0 \n| stats count(*) as connection_count, \n  sum(`connection-duration-seconds`/60) as total_connection_time_minutes \nby `username`, `common-name` \n| sort by total_connection_time_minutes desc\n",
}

var MutualAuthDistinctUsers = logs.QueryDefinition{
	Name: Sub{String: "${Folder}/Mutual Auth Distinct Users"},
	QueryString: "fields @timestamp, `client-vpn-endpoint-id`, `common-name`\n| sort @timestamp asc\n| stats count(*) as connection_count, latest(`client-vpn-endpoint-id`) as client_vpn_endpoint_id by `common-name`\n",
}

var MutualAuthDistinctUsersConnectionDuration = logs.QueryDefinition{
	Name: Sub{String: "${Folder}/Mutual Auth Users Duration"},
	QueryString: "fields @timestamp, `client-vpn-endpoint-id`, `common-name`, `ingress-bytes`, `egress-bytes`, `connection-duration-seconds` | sort @timestamp asc | filter `ingress-bytes` > 0 OR `egress-bytes` > 0 | stats count(*) as connection_count,\n  sum(`connection-duration-seconds`/60) as total_connection_time_minutes,\n  sum(`ingress-bytes`) as total_ingress_bytes,\n  sum(`egress-bytes`) as total_egress_bytes,\n  latest(`client-vpn-endpoint-id`) as client_vpn_endpoint_id\nby `common-name` | sort by total_ingress_bytes desc, total_egress_bytes desc\n",
}

var MutualAuthTotalUsageReport = logs.QueryDefinition{
	Name: Sub{String: "${Folder}/Mutual Auth Total Usage Report"},
	QueryString: "fields @timestamp, `client-vpn-endpoint-id`, `common-name`, `ingress-bytes`, `egress-bytes`, `connection-start-time`, `connection-end-time`, `connection-duration-seconds` \n| sort @timestamp asc \n| filter `ingress-bytes` > 0 OR `egress-bytes` > 0 \n| fields @timestamp, `client-vpn-endpoint-id`, `common-name`, `ingress-bytes`, `egress-bytes`, `connection-start-time`, `connection-end-time`, `connection-duration-seconds`, (`connection-duration-seconds`/60) as connection_time_minutes \n| sort by `ingress-bytes` desc, `egress-bytes` desc\n",
}

var MutualAuthUsersConnectionDuration = logs.QueryDefinition{
	Name: Sub{String: "${Folder}/Mutual Auth Distinct Users Connection Duration"},
	QueryString: "fields @timestamp, `client-vpn-endpoint-id`, `common-name`, `ingress-bytes`, `egress-bytes`, `connection-start-time`, `connection-end-time`, `connection-duration-seconds` sort @timestamp asc filter `ingress-bytes` > 0 OR `egress-bytes` > 0 stats count(*) as connection_count, sum(`connection-duration-seconds`/60) as total_connection_time_minutes by `common-name`\n",
}

var TotalUsagePerClientVPNEndpoint = logs.QueryDefinition{
	Name: Sub{String: "${Folder}/Total Usage per Client VPN Endpoint"},
	QueryString: "fields @timestamp, `client-vpn-endpoint-id`, `ingress-bytes`, `egress-bytes`, `connection-duration-seconds`, `username`, `common-name`\n| sort @timestamp asc\n| filter `ingress-bytes` > 0 OR `egress-bytes` > 0\n| stats\n    count(*) as connection_count,\n    min(@timestamp) as earliest_timestamp,\n    max(@timestamp) as latest_timestamp,\n    sum(`ingress-bytes`)/1048576 as total_ingress_MB,\n    sum(`egress-bytes`)/1048576 as total_egress_MB,\n    sum((`connection-duration-seconds`/60)/60) as total_connection_time_hours,\n    count_distinct(username) as unique_saml_ad_users,\n    count_distinct(`common-name`) as unique_mutual_auth_names\nby `client-vpn-endpoint-id`\n| sort by total_ingress_MB desc, total_egress_MB desc\n",
}
