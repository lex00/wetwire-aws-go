// Package log_setup_management contains CloudFormation resources.
// Security resources: IAM, Cognito, KMS, etc.
//
// Generated by wetwire-aws import.
package log_setup_management

import (
	. "github.com/lex00/wetwire-aws-go/intrinsics"
	"github.com/lex00/wetwire-aws-go/resources/kms"
)

var CentralEventLogKeyKeyPolicy = PolicyDocument{
	Statement: []any{CentralEventLogKeyKeyPolicyStatement0, CentralEventLogKeyKeyPolicyStatement1},
	Version: "2012-10-17",
}

var CentralEventLogKeyKeyPolicyStatement1 = PolicyStatement{
	Action: []any{"kms:Encrypt*", "kms:Decrypt*", "kms:ReEncrypt*", "kms:GenerateDataKey*", "kms:Describe*"},
	Effect: "Allow",
	Principal: ServicePrincipal{"logs.amazonaws.com"},
	Resource: Sub{String: "arn:aws:kms:${AWS::Region}:${AWS::AccountId}:key/*"},
	Sid: "Allow CloudWatch Logs to use the key",
}

var CentralEventLogKeyKeyPolicyStatement0 = PolicyStatement{
	Action: []any{"kms:Create*", "kms:Describe*", "kms:Enable*", "kms:List*", "kms:Put*", "kms:Update*", "kms:Revoke*", "kms:Disable*", "kms:Get*", "kms:Delete*", "kms:ScheduleKeyDeletion", "kms:CancelKeyDeletion", "kms:GenerateDataKey", "kms:TagResource", "kms:UntagResource"},
	Effect: "Allow",
	Principal: AWSPrincipal{Sub{String: "arn:aws:iam::${AWS::AccountId}:role/Admin"}},
	Resource: Sub{String: "arn:aws:kms:${AWS::Region}:${AWS::AccountId}:key/*"},
}

var CentralEventLogKey = kms.Key{
	Description: "KMS key for log group",
	EnableKeyRotation: true,
	KeyPolicy: CentralEventLogKeyKeyPolicy,
}
