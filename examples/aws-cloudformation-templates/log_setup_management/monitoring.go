// Package log_setup_management contains CloudFormation resources.
// Monitoring resources: CloudWatch, Logs, etc.
//
// Generated by wetwire-aws import.
package log_setup_management

import (
	"github.com/lex00/cloudformation-schema-go/enums"
	. "github.com/lex00/wetwire-aws-go/intrinsics"
	"github.com/lex00/wetwire-aws-go/resources/logs"
)

var CentralEventLog = logs.LogGroup{
	KmsKeyId: CentralEventLogKey.Arn,
	LogGroupClass: enums.LogsLogGroupClassStandard,
	LogGroupName: CentralEventLogName,
	RetentionInDays: 90,
}

var CentralEventLogPolicy = logs.ResourcePolicy{
	PolicyDocument: Sub{String: "{\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": [\n          \"delivery.logs.amazonaws.com\",\n          \"events.amazonaws.com\"\n        ]\n      },\n      \"Action\": [\n        \"logs:PutLogEvents\",\n        \"logs:CreateLogStream\"\n      ],\n      \"Resource\": \"${CentralEventLog.Arn}\"\n    }\n  ]\n}\n"},
	PolicyName: "CentralEventLogResourcePolicy",
}

var CentralEventLogQuery = logs.QueryDefinition{
	LogGroupNames: Any(CentralEventLogName),
	Name: "CentralCloudFormationEventLogs",
	QueryString: "fields time, account, region, `detail.resource-type`, `detail.logical-resource-id`, `detail.status-details.status` | sort @timestamp desc",
}

var CentralEventLogQueryReason = logs.QueryDefinition{
	LogGroupNames: Any(CentralEventLogName),
	Name: "CentralCloudFormationFailures",
	QueryString: "fields time, account, region, `detail.resource-type`, `detail.logical-resource-id`, `detail.status-details.status` as status, `detail.status-details.status-reason` as reason | sort @timestamp desc | filter status like \"FAILED\" | filter reason not like \"canceled\" | filter resource not like \"AWS::CloudFormation::Stack\" ",
}
